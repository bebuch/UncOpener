# UncOpener

[![CI](https://github.com/bebuch/UncOpener/actions/workflows/ci.yml/badge.svg)](https://github.com/bebuch/UncOpener/actions/workflows/ci.yml)
[![Release](https://github.com/bebuch/UncOpener/actions/workflows/release.yml/badge.svg)](https://github.com/bebuch/UncOpener/actions/workflows/release.yml)
[![codecov](https://codecov.io/gh/bebuch/UncOpener/graph/badge.svg)](https://codecov.io/gh/bebuch/UncOpener)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

A cross-platform Qt application that handles custom URL schemes for opening UNC network paths. This is the backend companion application for the [UncClickable](https://github.com/bebuch/UncClickable) browser extension.

## Overview

UncOpener enables seamless opening of UNC network paths directly from your web browser. When installed and registered, it intercepts URLs with a custom scheme (default: `uncopener://server/path/to/resource`) generated by the UncClickable extension and opens the corresponding network location.

### Features

- **Cross-platform support**: Works on Windows and Linux
- **Custom URL scheme handling**: Register and handle custom URL schemes
- **Security-first design**: UNC path allow-list and filetype filtering
- **Configuration GUI**: Easy setup of allowed paths and security policies
- **SMB support on Linux**: Converts UNC paths to `smb://` URLs for native file manager integration

## How It Works

1. The UncClickable browser extension detects UNC paths on web pages and converts them to clickable links with a custom URL scheme
2. When clicked, UncOpener receives the URL and:
   - Validates and normalizes the path
   - Checks against the UNC allow-list
   - Applies filetype policy (whitelist/blacklist)
   - Opens the path using the system's default handler

### Platform Behavior

- **Windows**: Opens the UNC path directly (e.g., `\\server\path\folder`)
- **Linux**: Converts to SMB URL (e.g., `smb://server/path/folder`) for file manager integration

## Security

UncOpener implements multiple security layers:

- **UNC Allow-list**: Only paths starting with entries in your allow-list can be opened
- **Filetype Policy**: Whitelist or blacklist file extensions to control what can be opened
- **Path Validation**: Strict validation rejects malformed paths and directory traversal attempts

## Installation

Pre-built binaries are available on the [Releases](https://github.com/bebuch/UncOpener/releases) page:

- **Windows**: Download the ZIP archive and extract to a location of your choice
- **Linux**: Download the AppImage, make it executable, and run

## Building from Source

### Requirements

- C++17 compatible compiler (Clang 18+ recommended)
- CMake 3.20+
- Ninja (with Multi-Config support)
- Qt 6

### Build Instructions

> **Important:** This project exclusively supports **Ninja Multi-Config**. Other generators (Visual Studio, Makefiles, single-config Ninja) are not supported and will fail at configuration time.

Use the provided CMake presets for all build operations:

```bash
# Configure (one-time, creates build/ directory)
cmake --preset default

# Build Debug
cmake --build --preset debug

# Build Release
cmake --build --preset release

# Run tests (Debug)
ctest --preset debug

# Run tests (Release)
ctest --preset release
```

## Configuration

Run UncOpener without arguments to open the configuration GUI. From there you can:

- Set the custom URL scheme name
- Manage the UNC path allow-list
- Configure filetype whitelist/blacklist
- Register/deregister the URL scheme handler
- (Linux only) Set SMB username for authentication

Configuration is stored per-user:
- Windows: `%APPDATA%/UncOpener/`
- Linux: `$XDG_CONFIG_HOME/uncopener/` or `~/.config/uncopener/`

## Related Projects

- **[UncClickable](https://github.com/bebuch/UncClickable)** - Browser extension that converts UNC paths in web pages to clickable links using the custom URL scheme handled by this application. Supports Firefox, Chrome, and Edge.

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.
